{"ast":null,"code":"import React,{useEffect,useRef}from'react';import L from'leaflet';import'leaflet/dist/leaflet.css';import'./MapComponent.css';// Fix for default markers in Leaflet with React\nimport{jsx as _jsx}from\"react/jsx-runtime\";delete L.Icon.Default.prototype._getIconUrl;L.Icon.Default.mergeOptions({iconRetinaUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png',iconUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png',shadowUrl:'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png'});const MapComponent=_ref=>{let{pings=[]}=_ref;const mapRef=useRef(null);const mapInstanceRef=useRef(null);const markersRef=useRef([]);useEffect(()=>{if(!mapInstanceRef.current&&mapRef.current){// Initialize map\nmapInstanceRef.current=L.map(mapRef.current).setView([-37.1,147.1],13);L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{attribution:'¬© OpenStreetMap contributors',maxZoom:18}).addTo(mapInstanceRef.current);}return()=>{if(mapInstanceRef.current){mapInstanceRef.current.remove();mapInstanceRef.current=null;}};},[]);useEffect(()=>{if(!mapInstanceRef.current)return;// Clear existing markers\nmarkersRef.current.forEach(marker=>{mapInstanceRef.current.removeLayer(marker);});markersRef.current=[];// Add new markers\npings.forEach(ping=>{const icon=getPingIcon(ping.type);const marker=L.marker([ping.latitude,ping.longitude],{icon}).addTo(mapInstanceRef.current).bindPopup(createPopupContent(ping));markersRef.current.push(marker);});// Auto-fit map to show all pings\nif(pings.length>0){const group=new L.featureGroup(markersRef.current);mapInstanceRef.current.fitBounds(group.getBounds().pad(0.1));}},[pings]);const getPingIcon=type=>{const iconConfig={iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]};switch(type){case'here':return L.divIcon({...iconConfig,html:'<div class=\"ping-marker ping-here\">üìç</div>',className:'custom-ping-icon'});case'meet':return L.divIcon({...iconConfig,html:'<div class=\"ping-marker ping-meet\">ü§ù</div>',className:'custom-ping-icon'});case'sos':return L.divIcon({...iconConfig,html:'<div class=\"ping-marker ping-sos\">üÜò</div>',className:'custom-ping-icon'});default:return new L.Icon.Default();}};const createPopupContent=ping=>{const time=new Date(ping.timestamp).toLocaleString();const typeEmoji={here:'üìç',meet:'ü§ù',sos:'üÜò'};return`\n      <div class=\"ping-popup\">\n        <div class=\"ping-popup-header\">\n          <span class=\"ping-popup-icon\">${typeEmoji[ping.type]||'üìç'}</span>\n          <span class=\"ping-popup-type\">${ping.type.toUpperCase()}</span>\n        </div>\n        ${ping.message?`<div class=\"ping-popup-message\">${ping.message}</div>`:''}\n        <div class=\"ping-popup-time\">${time}</div>\n      </div>\n    `;};return/*#__PURE__*/_jsx(\"div\",{ref:mapRef,className:\"map-container\"});};export default MapComponent;","map":{"version":3,"names":["React","useEffect","useRef","L","jsx","_jsx","Icon","Default","prototype","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","MapComponent","_ref","pings","mapRef","mapInstanceRef","markersRef","current","map","setView","tileLayer","attribution","maxZoom","addTo","remove","forEach","marker","removeLayer","ping","icon","getPingIcon","type","latitude","longitude","bindPopup","createPopupContent","push","length","group","featureGroup","fitBounds","getBounds","pad","iconConfig","iconSize","iconAnchor","popupAnchor","divIcon","html","className","time","Date","timestamp","toLocaleString","typeEmoji","here","meet","sos","toUpperCase","message","ref"],"sources":["/Users/jwono/Downloads/snowping-pwa/src/components/MapComponent.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react'\nimport L from 'leaflet'\nimport 'leaflet/dist/leaflet.css'\nimport './MapComponent.css'\n\n// Fix for default markers in Leaflet with React\ndelete L.Icon.Default.prototype._getIconUrl\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png',\n  iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png',\n  shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png',\n})\n\nconst MapComponent = ({ pings = [] }) => {\n  const mapRef = useRef(null)\n  const mapInstanceRef = useRef(null)\n  const markersRef = useRef([])\n\n  useEffect(() => {\n    if (!mapInstanceRef.current && mapRef.current) {\n      // Initialize map\n      mapInstanceRef.current = L.map(mapRef.current).setView([-37.1, 147.1], 13)\n      \n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '¬© OpenStreetMap contributors',\n        maxZoom: 18,\n      }).addTo(mapInstanceRef.current)\n    }\n\n    return () => {\n      if (mapInstanceRef.current) {\n        mapInstanceRef.current.remove()\n        mapInstanceRef.current = null\n      }\n    }\n  }, [])\n\n  useEffect(() => {\n    if (!mapInstanceRef.current) return\n\n    // Clear existing markers\n    markersRef.current.forEach(marker => {\n      mapInstanceRef.current.removeLayer(marker)\n    })\n    markersRef.current = []\n\n    // Add new markers\n    pings.forEach(ping => {\n      const icon = getPingIcon(ping.type)\n      const marker = L.marker([ping.latitude, ping.longitude], { icon })\n        .addTo(mapInstanceRef.current)\n        .bindPopup(createPopupContent(ping))\n\n      markersRef.current.push(marker)\n    })\n\n    // Auto-fit map to show all pings\n    if (pings.length > 0) {\n      const group = new L.featureGroup(markersRef.current)\n      mapInstanceRef.current.fitBounds(group.getBounds().pad(0.1))\n    }\n  }, [pings])\n\n  const getPingIcon = (type) => {\n    const iconConfig = {\n      iconSize: [32, 32],\n      iconAnchor: [16, 32],\n      popupAnchor: [0, -32],\n    }\n\n    switch (type) {\n      case 'here':\n        return L.divIcon({\n          ...iconConfig,\n          html: '<div class=\"ping-marker ping-here\">üìç</div>',\n          className: 'custom-ping-icon'\n        })\n      case 'meet':\n        return L.divIcon({\n          ...iconConfig,\n          html: '<div class=\"ping-marker ping-meet\">ü§ù</div>',\n          className: 'custom-ping-icon'\n        })\n      case 'sos':\n        return L.divIcon({\n          ...iconConfig,\n          html: '<div class=\"ping-marker ping-sos\">üÜò</div>',\n          className: 'custom-ping-icon'\n        })\n      default:\n        return new L.Icon.Default()\n    }\n  }\n\n  const createPopupContent = (ping) => {\n    const time = new Date(ping.timestamp).toLocaleString()\n    const typeEmoji = {\n      here: 'üìç',\n      meet: 'ü§ù',\n      sos: 'üÜò'\n    }\n    \n    return `\n      <div class=\"ping-popup\">\n        <div class=\"ping-popup-header\">\n          <span class=\"ping-popup-icon\">${typeEmoji[ping.type] || 'üìç'}</span>\n          <span class=\"ping-popup-type\">${ping.type.toUpperCase()}</span>\n        </div>\n        ${ping.message ? `<div class=\"ping-popup-message\">${ping.message}</div>` : ''}\n        <div class=\"ping-popup-time\">${time}</div>\n      </div>\n    `\n  }\n\n  return <div ref={mapRef} className=\"map-container\" />\n}\n\nexport default MapComponent"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}